package com.example.studentCourses.serviceLayer;

import java.time.LocalDateTime;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.stereotype.Service;

import com.example.studentCourses.Entity.RegisteredStudentsEntity;
import com.example.studentCourses.repository.RegisteredStudentsRepository;

@Service
public class RegisteredStudentsService {

	@Autowired
	private RegisteredStudentsRepository registeredStudentsRepository;
	
	@Autowired
	private PasswordEncoder passwordEncoder;
	
	public RegisteredStudentsEntity registerStudent(RegisteredStudentsEntity student) {
		String hashedPassword = passwordEncoder.encode(student.getsPassword());
		student.setsPassword(hashedPassword);
		student.setCreatedAt(LocalDateTime.now());
		student.setUpdatedAt(LocalDateTime.now());
		return registeredStudentsRepository.save(student);
	}
	
	public boolean loginStudent(RegisteredStudentsEntity student) {
		String hashedPassword = passwordEncoder.encode(student.getsPassword());
		student.setsPassword(hashedPassword);
		boolean checkLogin = registeredStudentsRepository.exists(student);
		if(checkLogin == true) return true;
		return false;
	}
}
